<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
  <title>Umple Generator Client</title>
  <script src="plugin.js"></script>    
  <script>
      var headers = { name: "Umple Generator Client", version: "1.0", description: "Generate code from .ump files" };
      var provider = new orion.PluginProvider(headers);

      var serviceImpl = { 
          execute: function(editorContext, options){

              // TODO: the location of the Orion/UmpleCodeGenerator server
              var umpleGenerateServerURL = "http://localhost:4567/UmpleGenerate";

              // TODO: get username and filename(s) for request
              // request is the username\nfilename0\nfilename1\nfilename3\n...
              //var request = "nwam\nUmpleProject/Shapes.ump";

              // request is just the currently selected file for now
              // unsure how this is formatted (not in the docs) so testing that right now
              var request = options.input;

              // build and send the request
              var x = new XMLHttpRequest();
              x.open("POST", umpleGenerateServerURL, true);               
              x.send(request);
          }
      };
 
      var serviceProperties = { 
          name: "Umple Generation",
          key: ["u", true, true] // Ctrl+Shift+u
      };

      provider.registerService("orion.edit.command", serviceImpl, serviceProperties);
      provider.connect();
  </script>
</head>
<body></body>
</html>
